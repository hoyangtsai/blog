{"componentChunkName":"component---src-templates-blog-post-js","path":"/google-cloud-install-shadowsocksr/","result":{"data":{"site":{"siteMetadata":{"title":"Traverse"}},"markdownRemark":{"id":"721038a7-4ad2-5d00-b422-40625bf68ed5","excerpt":"近幾年雲服務市場競爭激烈 \n從一開始的亞馬遜 AWS，接著微軟的 Microsoft Azure \n到最後 Google 也跳進來做 Google Cloud 谷歌雲服務 \n直接推出最優惠的試用方案: 一年免費試用，再送 300 美元試用額度 \n只要有 Google 帳號就可以馬上來申請 freetrial…","html":"<p>近幾年雲服務市場競爭激烈 <br>\n從一開始的亞馬遜 AWS，接著微軟的 Microsoft Azure <br>\n到最後 Google 也跳進來做 Google Cloud 谷歌雲服務 <br>\n直接推出最優惠的試用方案: <span class=\"hi-red\">一年免費試用，再送 300 美元試用額度</span> <br>\n只要有 Google 帳號就可以馬上來申請 <a href=\"https://console.cloud.google.com/freetrial\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">freetrial</a> <br></p>\n<!-- more -->\n<h2 id=\"建立-vm-執行個體\" style=\"position:relative;\"><a href=\"#%E5%BB%BA%E7%AB%8B-vm-%E5%9F%B7%E8%A1%8C%E5%80%8B%E9%AB%94\" aria-label=\"建立 vm 執行個體 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>建立 VM 執行個體</h2>\n<p>申請完成後 <br>\n直接進入 <a href=\"https://console.cloud.google.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Google Cloud 主控台</a> 建立一個新的專案，專案名稱可以隨便取</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; margin: initial;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 84.44444444444446%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAIAAABSJhvpAAAACXBIWXMAAAsTAAALEwEAmpwYAAABO0lEQVR42uWS3U7CMBiGd1kmmvhD1EuQg0nkGkANEKJnzOB+QmiZ12FiNNEQxuZFcMAZuKhjg9XRdnSzMOKBCTIPPPLJm6ZNvudr+iPsitc7opw5VjI5deNI3ssph3ll/2RlDvLKtqhsZuWtbF0oXcrn1fpZ9apYkQpl6bSyJsVKrVCuFctS6UIWbnRwf3f79PjwbHZMo93tLPI1+RajbZmGZXUNo63rQGi1WoPB0Bm5URwzxoefYFE0RYjZNrVt0GgIEAJ3HLw6/pszRh80wLPVYSjA77aNer2g34eJ7E2mmIaMzXjvaB3xoogSAiHkMvT9ychxhsMXjPFanzHGa5YyAABjkhwpSsdcpnQpE0LiXxKG4T+W07zQH9x2s9lECPEFTcEspJ5P+Hf2PHcua5rGN4epAUkAUFX1E2OvZbWI/lOtAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"建立專案\"\n        title=\"\"\n        src=\"/traverse/static/374108797569f5471a895b13d412248f/37523/new-project.png\"\n        srcset=\"/traverse/static/374108797569f5471a895b13d412248f/e9ff0/new-project.png 180w,\n/traverse/static/374108797569f5471a895b13d412248f/f21e7/new-project.png 360w,\n/traverse/static/374108797569f5471a895b13d412248f/37523/new-project.png 720w,\n/traverse/static/374108797569f5471a895b13d412248f/bad1b/new-project.png 841w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>再到專案中的 Computer Engine 建立 VM 執行個體</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; margin: initial;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47.77777777777777%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA9ElEQVR42o1R2W7DIBDk/z+vT5VbbFInaWxO2xAgHO4aqqqKoyjzuMswxyIl2ayEFNy7awi3cRz7vtdar+uaUspPgT5P5uNoDhf9NZhJe+A752KM+QWg7iTf24FKT6UzNoBgzuuLQFIwTocUfIo+pXi39t5DECnl3TwXBcSFuBXAO3C7J1NKhRCwggpCCLGg1oE459ZamD4kX43+Ph+7rsMYt20LXRJCmqZZlmVTho8ZY3vlGlwo3eD+QAg4H+kvgAliGxmYIL5XrrWRi33Di3cWtsYY8D/Pc8282YaflFK+YG/7/2H+JjXwpjxNUyh4SH5+qh8zL0aoHwGFsQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"建立 VM 執行個體\"\n        title=\"\"\n        src=\"/traverse/static/267f0fecd30d720ed550d7607d77fcba/37523/create-vm-instance.png\"\n        srcset=\"/traverse/static/267f0fecd30d720ed550d7607d77fcba/e9ff0/create-vm-instance.png 180w,\n/traverse/static/267f0fecd30d720ed550d7607d77fcba/f21e7/create-vm-instance.png 360w,\n/traverse/static/267f0fecd30d720ed550d7607d77fcba/37523/create-vm-instance.png 720w,\n/traverse/static/267f0fecd30d720ed550d7607d77fcba/e548f/create-vm-instance.png 975w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>名稱：名稱隨便取，像 instance-1</li>\n<li>區域：如果是要翻牆，建議選 asia-northeast 或 asia-east\n<blockquote>\n<p>亞洲區的分別在</p>\n<ol>\n<li>asia-northeast -> 日本</li>\n<li>asia-east -> 台灣</li>\n<li>asia-southeast -> 新加坡</li>\n</ol>\n<p>其他區域: <a href=\"https://cloud.google.com/about/locations\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://cloud.google.com/about/locations</a></p>\n</blockquote>\n</li>\n<li>機器類型：微型</li>\n<li>開機磁碟：CentOS 6</li>\n<li>身分及 API 存取權，不用修改</li>\n<li>防火牆，不用修改</li>\n<li>網路用預設的，系統會自動配一個臨時 IP 位址\n<blockquote>\n<p>IP 用臨時就可以了，因為一個專案每一個區域只能申請一個免費的固定 IP</p>\n</blockquote>\n</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; margin: initial;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 97.22222222222223%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAIAAAAf7rriAAAACXBIWXMAAAsTAAALEwEAmpwYAAABgUlEQVR42o1U7XKCMBDM+z+c/akdxZYUkA9BEkiAJJCuxFIGRb1hhiPkNre7B0Qbe84LSqnneXmeW2uHYbDvBWnaawyvov+L+SLhnMdJ4lYX71wLjDFjzOOTUYxu67pWSk3w2L3IsUEIXGIORAAcRSchpNbajOFacLm74/EUJ/QniOP4crmIMbBIABlFYVVVYA4wQCBvmsYp1+mbeK0amOiXbWvTR2lFaXA+ZwACcBiGSFyx0lfeI/nh3giCA4WUTs5J2IXOq1ahyeCUVXXbyIYxXpasbTscMJd8zXgC4Li0Ucqp/w3xgAXZp9dQy2mxWiyVbTvN+c3PucmohJerxTjteDxCJKf+6NeVtbvmQA+Ku67zfT/LsqIoMC0lgrGb48bAObBYLVbabLefCMcWfd4P6Wox1j3v62Oz2e12h8MhSZL7SX5S/G8vmlzUvDgZVPf7PThjtqSU0A+skSOBHM8/bwKe7k+Qpim26Vk8ma1ptoey6su658Kwup++hHf+JL8yVFng/bceJQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"新 VM 執行個體\"\n        title=\"\"\n        src=\"/traverse/static/03468b22b8e6f7092ac2289a3dd0fad4/37523/new-vm-instance.png\"\n        srcset=\"/traverse/static/03468b22b8e6f7092ac2289a3dd0fad4/e9ff0/new-vm-instance.png 180w,\n/traverse/static/03468b22b8e6f7092ac2289a3dd0fad4/f21e7/new-vm-instance.png 360w,\n/traverse/static/03468b22b8e6f7092ac2289a3dd0fad4/37523/new-vm-instance.png 720w,\n/traverse/static/03468b22b8e6f7092ac2289a3dd0fad4/5e3a3/new-vm-instance.png 763w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>機器類型選擇微型，是因為只是要用 ShadowsocksR 服務不需要太多電腦運算能力，而且價差非常的大。</p>\n<p>之前建立一個 VM 在使用幾天後，Google Cloud 平台就建議將微型 vCPU 升級到小型，用了一個月後試用額度也從 300 USD 扣到只剩 220 USD 左右 (當然也跟我每天晚上都看 youtube 也有關係)</p>\n<p>後來我發現… Google Cloud 有個更大的陰謀 <br>\n就是我建立一個 VM 執行個體，在沒有運行任何程式的情況下 <br>\n過幾天再登入，居然也出現「提升效能」的建議，所以真的可以不用理會平台的升級建議</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; margin: initial;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 18.88888888888889%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAmklEQVR42iWNSRbDIAxDc/8rdtPXLshECcZmMJBUIX/Bs4RlTcGZbbdEPsZorV3X1Xu/LMs8z2EAycwpJXxh8NxI6nXeTEKeSHLOz6qIBObd/rD3ODiKV1WJCFbMPZXWB9OHjs0dVRW1zrmiWrJ8368QGJ1oQ8wYgyQGyFZv+tNMVYKwFsWlPDh7ywnFDKeU0gYYkEEeJuQ1+AOnPeWpHuNVUwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"建議升級訊息\"\n        title=\"\"\n        src=\"/traverse/static/62e0f3b6636e2fdb3fcdd350ec372b6d/37523/upgrade-notice.png\"\n        srcset=\"/traverse/static/62e0f3b6636e2fdb3fcdd350ec372b6d/e9ff0/upgrade-notice.png 180w,\n/traverse/static/62e0f3b6636e2fdb3fcdd350ec372b6d/f21e7/upgrade-notice.png 360w,\n/traverse/static/62e0f3b6636e2fdb3fcdd350ec372b6d/37523/upgrade-notice.png 720w,\n/traverse/static/62e0f3b6636e2fdb3fcdd350ec372b6d/d44c9/upgrade-notice.png 722w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"下載-shadowsocksr-源碼\" style=\"position:relative;\"><a href=\"#%E4%B8%8B%E8%BC%89-shadowsocksr-%E6%BA%90%E7%A2%BC\" aria-label=\"下載 shadowsocksr 源碼 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>下載 ShadowsocksR 源碼</h2>\n<p>建立完成後，在瀏覽器視窗中開啟</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; margin: initial;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.22222222222223%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAAA3ElEQVR42pVQXW+DMAzM//9z6yMSUqeGaYD4CAlJSIid7ArS2m0v6z2cLMvn81kYY5qmqevae8+5fE5pNGQ3doGVpUQ8appWJqIYAzOH8GCBbgjbXclcSmHOz0CHMBojivwHIqVktHXOpwMYAscY933H3rP+Xv0LIlGSalZKG6O7rrPWaq2XZRmGQSk1TVPf9xB3fb8iCdMPMTGtwSI5YsDEOXd6gtEBbwf8tt3kB14jpZznGQYYFuXfeL9e3y6XqqratsWNWP2CeBzvEWCLc47X8gvi8/lgPpBz/gJLr9JHpnLCcAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"在瀏覽器視窗中開啟\"\n        title=\"\"\n        src=\"/traverse/static/11bf2c1617914f784bd77c4243f37bdd/37523/open-with-browser.png\"\n        srcset=\"/traverse/static/11bf2c1617914f784bd77c4243f37bdd/e9ff0/open-with-browser.png 180w,\n/traverse/static/11bf2c1617914f784bd77c4243f37bdd/f21e7/open-with-browser.png 360w,\n/traverse/static/11bf2c1617914f784bd77c4243f37bdd/37523/open-with-browser.png 720w,\n/traverse/static/11bf2c1617914f784bd77c4243f37bdd/5a190/open-with-browser.png 800w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>登入 console 直接切換管理者角色 <code class=\"language-text\">sudo su</code> <br>\n避免之後安裝套件或執行程式權限不足</p>\n<p>更新一下套件中心 <code class=\"language-text\">yum update -y</code></p>\n<p>因為 <a href=\"https://github.com/shadowsocksr-backup/shadowsocksr\">ShadowsocksR</a> 要從 github 下載 <br>\n(08/20/2017 更新：先前的 repo 不知什麼原因刪除了，重新在 github 上面找到備份版本，同時我也在 GitLab <a href=\"https://gitlab.com/hoyangtsai/shadowsocksr\">備份</a> 一個，避免之後又不見。)</p>\n<p>先安裝 git 工具 <code class=\"language-text\">yum install git -y</code></p>\n<p>再下載 ShadowsocksR 源碼</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token builtin class-name\">cd</span> ~ <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">git</span> clone https://github.com/shadowsocksr-backup/shadowsocksr.git <span class=\"token operator\">&amp;&amp;</span> <span class=\"token builtin class-name\">cd</span> shadowsocksr <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">git</span> checkout <span class=\"token parameter variable\">-b</span> manyuser origin/manyuser</code></pre></div>\n<p>下載完後 <br>\n執行 <code class=\"language-text\">bash initcfg.sh</code> 自動生成初始配置檔案</p>\n<p>用 <code class=\"language-text\">vim user-config.json</code> 編輯使用者配置</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token punctuation\">{</span>\n    <span class=\"token string-property property\">\"server\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"0.0.0.0\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string-property property\">\"server_ipv6\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"::\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string-property property\">\"server_port\"</span><span class=\"token operator\">:</span> <span class=\"token number\">3888</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 任何 0 - 65535 port</span>\n    <span class=\"token string-property property\">\"local_address\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"127.0.0.1\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string-property property\">\"local_port\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1080</span><span class=\"token punctuation\">,</span>\n\n    <span class=\"token string-property property\">\"password\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// shadowsocksr 客戶端登入密碼</span>\n    <span class=\"token string-property property\">\"method\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"aes-256-cfb\"</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 加密方式</span>\n    <span class=\"token string-property property\">\"protocol\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"auth_aes128_md5\"</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 加密協議</span>\n    <span class=\"token string-property property\">\"protocol_param\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string-property property\">\"obfs\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"tls1.2_ticket_auth_compatible\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string-property property\">\"obfs_param\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"akamai.com,cloudflare.com\"</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 混淆參數 akamai.com,cloudflare.com</span>\n\n    <span class=\"token comment\">// 其他保留預設</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; margin: initial;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 77.77777777777777%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAABd0lEQVR42tWUy07CQBSG5yEI4ZJAp1faArqQIimIboVeWBEWfVwTE5GWbijwIi6Mv6dDvOBCEdy4+PJ3TjvfzOS0ZXfre6SrFZJlijhOkFJmWYb1eo3FIsbiMUaappg/zJEkS1HfbDYiM2K73YpxPoeun1k09jH1xpiOPUw8D7ejETxK3/cRBAHCcIIwCClDMfY9X9z7TF6Pogiz2QysWyyiVyjAMQyc6wZqpRIqlQrK5fKvqFarYh7rcg5HltGxbdi6Dk1RoJwAu6rX0SPhgNIlOrRALuVUk4+AXZNkWJfQlzgGVHBol01Jgs0lNAlZwHfI/GfhJQkvSOBQnqkqzIZJO9ShaCZhfaA2ICsaTVK+F97UahjSQ8NWGxYJG4oKQzUg5xLd3slE0gJ5/RDhgHbY1zS0CY3gb0d8P650+JFbJGvThUWonB/ViD1h3k1+omRPKP+h7F8IX5hETTlFwr80krmuC5Xev2NllmnBoB9L/h2bpvX0CrIR9VG8glLqAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"編輯使用者配置\"\n        title=\"\"\n        src=\"/traverse/static/6082f2970781996efe9e64ae09199297/37523/edit-user-config.png\"\n        srcset=\"/traverse/static/6082f2970781996efe9e64ae09199297/e9ff0/edit-user-config.png 180w,\n/traverse/static/6082f2970781996efe9e64ae09199297/f21e7/edit-user-config.png 360w,\n/traverse/static/6082f2970781996efe9e64ae09199297/37523/edit-user-config.png 720w,\n/traverse/static/6082f2970781996efe9e64ae09199297/1cfc2/edit-user-config.png 900w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"設定-iptables\" style=\"position:relative;\"><a href=\"#%E8%A8%AD%E5%AE%9A-iptables\" aria-label=\"設定 iptables permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>設定 iptables</h2>\n<p>將上面 user-config.json 設定的 server_port ，同樣設定到系統的 iptables 對應輸入的埠</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">iptables <span class=\"token parameter variable\">-I</span> INPUT <span class=\"token parameter variable\">-p</span> tcp <span class=\"token parameter variable\">--dport</span> <span class=\"token operator\">&lt;</span>server_port<span class=\"token operator\">></span> <span class=\"token parameter variable\">-j</span> ACCEPT\niptables <span class=\"token parameter variable\">-I</span> INPUT <span class=\"token parameter variable\">-p</span> udp <span class=\"token parameter variable\">--dport</span> <span class=\"token operator\">&lt;</span>server_port<span class=\"token operator\">></span> <span class=\"token parameter variable\">-j</span> ACCEPT</code></pre></div>\n<p>儲存設置，重新啟動 iptables</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">/etc/rc.d/init.d/iptables save\n/etc/init.d/iptables restart</code></pre></div>\n<p>執行 <code class=\"language-text\">/etc/init.d/iptables status</code> 檢查設定是否成功</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; margin: initial;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA80lEQVR42m2Q3W6EIBSEfRNXxa4aVxMtKKjxZxUFrJps3/9ZOvWiSbN+F+SEzGGGsdbV7Ns2DsO2Hfu2K6WllOM0reuX1mboBy4EY6wsued57n+s49iXZQbGrPO8jOPY9z3OrusEF2n2IHf3Zt+A+4b1+n7NUmqlfzefT875xwkhxHXc6BGE8R3DJZYxRitV13Xbdk3TpGkaRVGSJJSxPM9934eInFwsF0Uh5ZRlmahAzbmwbZt4pG1bSilmPIcZid6TW7ht6oZRVFJWogqCwHEc+MRxjAhQoCf4XzsL1MLFZ56fzlUYhnCAGpnh+adzrr79A3uoTgQ81+J4AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"檢查 iptables 設定\"\n        title=\"\"\n        src=\"/traverse/static/c14f8d114a83404bf00a9924187ede82/37523/check-iptables.png\"\n        srcset=\"/traverse/static/c14f8d114a83404bf00a9924187ede82/e9ff0/check-iptables.png 180w,\n/traverse/static/c14f8d114a83404bf00a9924187ede82/f21e7/check-iptables.png 360w,\n/traverse/static/c14f8d114a83404bf00a9924187ede82/37523/check-iptables.png 720w,\n/traverse/static/c14f8d114a83404bf00a9924187ede82/1cfc2/check-iptables.png 900w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>其他 iptables 指令說明 <a href=\"https://www.digitalocean.com/community/tutorials/how-to-list-and-delete-iptables-firewall-rules\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://www.digitalocean.com/community/tutorials/how-to-list-and-delete-iptables-firewall-rules</a></p>\n<h2 id=\"安裝-bbr\" style=\"position:relative;\"><a href=\"#%E5%AE%89%E8%A3%9D-bbr\" aria-label=\"安裝 bbr permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>安裝 BBR</h2>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">wget</span> --no-check-certificate https://github.com/teddysun/across/raw/master/bbr.sh\n<span class=\"token function\">chmod</span> <span class=\"token number\">755</span> bbr.sh\n./bbr.sh</code></pre></div>\n<p>啟動時，程式會要求按任何鍵確認開始執行安裝，安裝過程會花比較長的時間 <br>\n安裝完成後，一樣會要求使用者按 y 確認執行重新開機</p>\n<p>重新開機後，再次連接登入系統執行 <code class=\"language-text\">uname -r</code> 確認有更新到 4.10 以上即可</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 706px; margin: initial;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 9.444444444444445%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAaElEQVR42nXMMRKDIBRFUZcBhRD/FxSs7LMD4piZZBL2v5ErQ50UZ+6r3rDfI+Po8d4z3aZe5xyqSt4yKSeWdSGllTnMiArGGKy1Pw3v14fHcXCeT2qtfJtSCjFGRKTRfq5t9zYhhL8uS0I7GHXE8Y4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"檢查 BBR 版本\"\n        title=\"\"\n        src=\"/traverse/static/96fffd5f1b9dbe1b1a1b105c23ba57d6/9f21b/bbr-uname-check.png\"\n        srcset=\"/traverse/static/96fffd5f1b9dbe1b1a1b105c23ba57d6/e9ff0/bbr-uname-check.png 180w,\n/traverse/static/96fffd5f1b9dbe1b1a1b105c23ba57d6/f21e7/bbr-uname-check.png 360w,\n/traverse/static/96fffd5f1b9dbe1b1a1b105c23ba57d6/9f21b/bbr-uname-check.png 706w\"\n        sizes=\"(max-width: 706px) 100vw, 706px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"新增防火牆規則\" style=\"position:relative;\"><a href=\"#%E6%96%B0%E5%A2%9E%E9%98%B2%E7%81%AB%E7%89%86%E8%A6%8F%E5%89%87\" aria-label=\"新增防火牆規則 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>新增防火牆規則</h2>\n<p>根據上面 user-config.json 設定的 server_port，開啟對外 ip 輸入，對應的 tcp 和 udp 埠</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; margin: initial;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 90.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAIAAADUsmlHAAAACXBIWXMAAAsTAAALEwEAmpwYAAABw0lEQVR42oVT7XKbMBDk/R+ir9HX6B+3TTxggwlfAYG+hSQga+GQhrjxzo0Ga7S3d3vnqCzLqqqGYbDWjoAxo5sp45dLliRJnufLskzTNN9D1Pc94xwxvgN0pTQ+tNbGmOmGeUuxfURD3zFKSNc4ayZv58lxzuu6huC7wLTFNHkXsAREf1KO+HWkcSHTWmeNGZjI0hSNSCm1VlxarhyTjgo3Wr/K3siXimblULSKMNtRg5NzCRfAVEqhbKGd0B58riB7K/hGFnygA6F9h5rXsoVUp3O2vfgGUUcIpZT0PewZ4bhzUukkOcNIeHbtPLxDqq/Jrm4DMAk2BK5V2qTZBXN7KB6BRgjBPPsg7pyXUjRNzRjDjfd++gwf8EEG2rbFa9QJfaQ4Ho+4EUI8IA8BXdehc/BXchzHcDvslt+F9+6DHIapcUIHJ6bBhPr9N45PubGLHuddKDNjf29kTNJ9Buab5y9VVcM9VL0L3LlNGbI2AA0Ht52SWJISLuLnuslfsSdvgGuHw+H56akoCizZd6Paka9zNvb80hVF2bavKOTun/EOGYUvszsV6sfPpnqlW3n/VYbDa7f/pBi5MEI66x5s2BvEphY8aa2RmwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"新增防火牆規則\"\n        title=\"\"\n        src=\"/traverse/static/3724d53967ac68856c28bd7c432baf78/37523/new-firewall-rules.png\"\n        srcset=\"/traverse/static/3724d53967ac68856c28bd7c432baf78/e9ff0/new-firewall-rules.png 180w,\n/traverse/static/3724d53967ac68856c28bd7c432baf78/f21e7/new-firewall-rules.png 360w,\n/traverse/static/3724d53967ac68856c28bd7c432baf78/37523/new-firewall-rules.png 720w,\n/traverse/static/3724d53967ac68856c28bd7c432baf78/02cd5/new-firewall-rules.png 821w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"啟動-ssr-服務\" style=\"position:relative;\"><a href=\"#%E5%95%9F%E5%8B%95-ssr-%E6%9C%8D%E5%8B%99\" aria-label=\"啟動 ssr 服務 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>啟動 SSR 服務</h2>\n<p>全部完成後就可以啟動 SSR server</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token builtin class-name\">cd</span> ~/shadowsocksr/shadowsocks <span class=\"token operator\">&amp;&amp;</span> python server.py <span class=\"token parameter variable\">-d</span> start</code></pre></div>\n<p>啟動 BBR</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">sysctl</span> net.ipv4.tcp_available_congestion_control\n<span class=\"token function\">sysctl</span> net.ipv4.tcp_congestion_control\n<span class=\"token function\">sysctl</span> net.core.default_qdisc\n\n<span class=\"token comment\">## 驗證 BBR 是否運行</span>\nlsmod <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> bbr</code></pre></div>\n<h2 id=\"安裝客戶端\" style=\"position:relative;\"><a href=\"#%E5%AE%89%E8%A3%9D%E5%AE%A2%E6%88%B6%E7%AB%AF\" aria-label=\"安裝客戶端 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>安裝客戶端</h2>\n<ul>\n<li>Mac 系統，推薦 <a href=\"https://github.com/shadowsocks/ShadowsocksX-NG/releases\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ShadowsocksX-NG</a></li>\n<li>iOS 系統，推薦 <a href=\"https://itunes.apple.com/app/shadowrocket/id932747118\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Shadowrocket</a></li>\n<li>Android 系統，推薦 <a href=\"https://github.com/shadowsocksr-backup/shadowsocksr-android/releases\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">shadowsocksr-android</a></li>\n</ul>\n<p>對照 user-config.json 設定客戶端即可 <strong>打完收工</strong></p>\n<h2 id=\"備註\" style=\"position:relative;\"><a href=\"#%E5%82%99%E8%A8%BB\" aria-label=\"備註 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>備註</h2>\n<p>如果是使用 chacha20-ietf 加密方法 <br>\n直接啟動 SSR server 會出現 ‘libsodium not found’ 的錯誤</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; margin: initial;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABNUlEQVR42nWR/W6CMBTFfZIpKLiIlJaW8lGCFFoQhpqx93+XHWRZ5h87aSiQ/u4993Rzv9+wLlB1sbbL8zw8nyNCzkFASOR5nuM47j/a1HXdd51SKoWk5JzHcez7/vZtC+12Oxxy/ugFFlz0XW+MbY1ptDatUUXhef77quMRhZ77cf3xAicygdtpmuZ5HoZx/vwyxqRp1i0Vjdaax1wujuI8L0pVhmG42llhCQbr8XgM16HWuq51lma6aRvdIAjANKKMUkKIEBwWfs1vkkSiycc0AR5H7LfOWkye5YWUSw6Yi7F4KUEpQsEcyOIH5kJY2yNyOK+qCg3LsmSMKVWiP6xCaAASQVLKEiFOp9N+v1/gNMuaph3HERPipaouAIQQ0dMnbgvXhjkBBEGAJwnxTQ6Hg+u63w5jYIWN6ELQAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"libsodium not found\"\n        title=\"\"\n        src=\"/traverse/static/c3ad620788251ab8f9bda2a3d81af892/37523/libsodium-not-found.png\"\n        srcset=\"/traverse/static/c3ad620788251ab8f9bda2a3d81af892/e9ff0/libsodium-not-found.png 180w,\n/traverse/static/c3ad620788251ab8f9bda2a3d81af892/f21e7/libsodium-not-found.png 360w,\n/traverse/static/c3ad620788251ab8f9bda2a3d81af892/37523/libsodium-not-found.png 720w,\n/traverse/static/c3ad620788251ab8f9bda2a3d81af892/66caf/libsodium-not-found.png 853w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>需要安裝 libsodium 套件</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">yum <span class=\"token parameter variable\">-y</span> groupinstall <span class=\"token string\">\"Development Tools\"</span>\n<span class=\"token function\">wget</span> https://github.com/jedisct1/libsodium/releases/download/1.0.12/libsodium-1.0.12.tar.gz\n<span class=\"token function\">tar</span> zxf libsodium-1.0.12.tar.gz <span class=\"token operator\">&amp;&amp;</span> <span class=\"token builtin class-name\">cd</span> libsodium*\n./configure <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">make</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">make</span> <span class=\"token function\">install</span>\n<span class=\"token builtin class-name\">echo</span> /usr/local/lib <span class=\"token operator\">></span> /etc/ld.so.conf.d/usr_local_lib.conf\nldconfig</code></pre></div>","frontmatter":{"title":"Google Cloud 安裝 ShadowsocksR","date":"June 25, 2017","description":"試用 Google Cloud 安裝 ShadowsocksR 翻牆上網","tags":["gettingStarted"],"donation":true}},"previous":{"fields":{"slug":"/install-multiple-version-of-nodejs/"},"frontmatter":{"title":"安裝多版本 Node.js"}},"next":{"fields":{"slug":"/cross-platform-proxy-tool/"},"frontmatter":{"title":"跨平台 proxy 代理工具"}}},"pageContext":{"id":"721038a7-4ad2-5d00-b422-40625bf68ed5","previousPostId":"464bf47c-6272-5bf0-ba6a-af2bca681081","nextPostId":"4f056518-5b27-54d6-9da8-fa0cf91852e1"}},"staticQueryHashes":["1824009237","2841359383"],"slicesMap":{}}