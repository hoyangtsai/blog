{"componentChunkName":"component---src-templates-blog-post-js","path":"/mac-using-homebrew-install-mariadb/","result":{"data":{"site":{"siteMetadata":{"title":"Traverse"}},"markdownRemark":{"id":"7062f5b0-0302-5860-98b7-84162f2ad67f","excerpt":"最近我在檢查 Mac Mini 的 server 工作是否正常的時候發現 MySQL 資料庫又掛了 不是流量太大或電腦有問題，而是 MySQL 無法啟動 試著打  終端機印出  網路搜尋到的方法 像是  列出 mysql 程序把它砍掉 或是刪除  都無法啟動 MySQL 完整移除 MySQL Mac OS 從 10.…","html":"<p>最近我在檢查 Mac Mini 的 server 工作是否正常的時候發現 MySQL 資料庫又掛了</p>\n<p>不是流量太大或電腦有問題，而是 MySQL 無法啟動</p>\n<p>試著打 <code class=\"language-text\">mysql.server start</code></p>\n<p>終端機印出 <code class=\"language-text\">ERROR! The server quit without updating PID file (/usr/local/mysql/data/...pid)</code></p>\n<p>網路搜尋到的方法</p>\n<p>像是 <code class=\"language-text\">ps -aux | grep 'mysql'</code> 列出 mysql 程序把它砍掉</p>\n<p>或是刪除 <code class=\"language-text\">rm /usr/local/mysql/data/*.err</code> 都無法啟動 MySQL</p>\n<h2 id=\"完整移除-mysql\" style=\"position:relative;\"><a href=\"#%E5%AE%8C%E6%95%B4%E7%A7%BB%E9%99%A4-mysql\" aria-label=\"完整移除 mysql permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>完整移除 MySQL</h2>\n<p>Mac OS 從 10.9 Mavericks、10.10 Yosemite 到 10.11 El Capitan</p>\n<p>MySQL 隨著改版更新，但是安裝檔也不再附 MySQL 控制面板的安裝程式</p>\n<p>MySQL GUI Tools 也沒有持續維護，導致使用上越來越不方便，相容性也越來越差</p>\n<p>於是決定把整個 MySQL 砍掉重練，完整移除腳本如下</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">rm</span> /usr/local/mysql\n<span class=\"token function\">sudo</span> <span class=\"token function\">rm</span> -rf /usr/local/mysql*\n<span class=\"token function\">sudo</span> <span class=\"token function\">rm</span> -rf /Library/StartupItems/MySQLCOM\n<span class=\"token function\">sudo</span> <span class=\"token function\">rm</span> -rf /Library/PreferencePanes/My*\n<span class=\"token function\">rm</span> -rf ~/Library/PreferencePanes/My*\n<span class=\"token function\">sudo</span> <span class=\"token function\">rm</span> -rf /Library/Receipts/mysql*\n<span class=\"token function\">sudo</span> <span class=\"token function\">rm</span> -rf /Library/Receipts/MySQL*\n<span class=\"token function\">sudo</span> <span class=\"token function\">rm</span> -rf /private/var/db/receipts/*mysql*</code></pre></div>\n<h2 id=\"用-homebrew-安裝資料庫\" style=\"position:relative;\"><a href=\"#%E7%94%A8-homebrew-%E5%AE%89%E8%A3%9D%E8%B3%87%E6%96%99%E5%BA%AB\" aria-label=\"用 homebrew 安裝資料庫 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>用 Homebrew 安裝資料庫</h2>\n<p>使用 Homebrew 安裝函式庫的好處就是不用再做麻煩的環境設定，像是 <code class=\"language-text\">export PATH=$PATH:${new_path}</code> 之類的</p>\n<p>因為在 <code class=\"language-text\">brew install [library]</code> 的時候 Homebrew 就會從 /usr/local/Cellar/[library] 的指令庫底下，做個 symbolic 鏈結到 /usr/local/bin/</p>\n<p>函式庫相關的指令就可以直接使用，未來也只要透過 <code class=\"language-text\">brew upgrade</code> 就可以更新函式庫了</p>\n<h2 id=\"開始安裝-mariadb\" style=\"position:relative;\"><a href=\"#%E9%96%8B%E5%A7%8B%E5%AE%89%E8%A3%9D-mariadb\" aria-label=\"開始安裝 mariadb permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>開始安裝 MariaDB</h2>\n<p>之前用過 <code class=\"language-text\">brew install mysql</code> 安裝 MySQL 資料庫，嘗試很久安裝一直失敗後來就放棄了。<br></p>\n<p>這次我改安裝 MariaDB，順便做了一下調查…<br></p>\n<p>MariaDB 可以說是 MySQL 的表兄弟，它是由 MySQL 的開發元老 Widenius 分支出來開發的專案<br></p>\n<p>如官方的聲明</p>\n<blockquote>\n<p>MariaDB is a binary drop in replacement for MySQL.</p>\n</blockquote>\n<p>所以主要考慮的點在：</p>\n<ul>\n<li>資料和表格定義檔 (.frm) 是二進制相容。</li>\n<li>所有客戶端 APIs、協定和架構的一致性。</li>\n<li>所有檔案名稱、二進制檔、路徑、port、sockets … 等應該會一樣。</li>\n<li>所有 MySQL 連接器 (PHP, Perl, Python, Java, .NET, MyODBC, Ruby, MySQL C connector 等) 與 MariaDB 運行不會改變。</li>\n<li>mysql-client 套件也在 MariaDB server 中運行。</li>\n<li>共享的客戶端函式庫和 MySQL 客戶端函式庫是二進制相容。</li>\n</ul>\n<p>還包含一些 MySQL 沒有的特點，像是 Aria 儲存引擎可以有更快的複雜查詢、多種效能的優化 … 等等。<br>\n更重要的是，MariaDB 有完整的<a href=\"https://mariadb.com/kb/en/mariadb/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">官方文件</a><br>\n使用 Homebrew 安裝，也有<a href=\"https://mariadb.com/kb/en/mariadb/building-mariadb-on-mac-os-x-using-homebrew/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">詳細的說明</a>，所以這裡直接提出幾個安裝重點</p>\n<ol>\n<li>\n<p>更新 Homebrew 函式庫</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">brew update</code></pre></div>\n</li>\n<li>\n<p>安裝 MariaDB</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">brew <span class=\"token function\">install</span> mariadb</code></pre></div>\n</li>\n<li>\n<p>安裝資料庫</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token builtin class-name\">unset</span> TMPDIR\nmysql_install_db</code></pre></div>\n</li>\n<li>\n<p>啟動資料庫 (操作指令和使用 MySQL 一樣)</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">mysql.server start</code></pre></div>\n</li>\n<li>\n<p>設定 root 登入密碼和其他 configuration 完成安裝</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">mysql_secure_installation</code></pre></div>\n</li>\n</ol>\n<p>如果想在電腦登入時自動啟動 MariaDB</p>\n<p>可以做個 symbolic 鏈結到 ~/Library/LaunchAgents/ 指令如下</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">ln</span> -s /usr/local/Cellar/mariadb/10.1.9/homebrew.mxcl.mariadb.plist ~/Library/LaunchAgents/\nlaunchctl load -w homebrew.mxcl.mariadb.plist</code></pre></div>\n<h2 id=\"參考\" style=\"position:relative;\"><a href=\"#%E5%8F%83%E8%80%83\" aria-label=\"參考 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>參考</h2>\n<ul>\n<li><a href=\"https://gist.github.com/brandonsimpson/5204ce8a46f7a20071b5\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">OSX How To: Uninstall native MySQL and install MariaDB via Homebrew</a></li>\n<li><a href=\"https://mariadb.com/kb/en/mariadb/mariadb-vs-mysql-compatibility/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">MariaDB versus MySQL - Compatibility</a></li>\n<li><a href=\"http://www.interworx.com/community/mariadb-vs-mysql-whats-the-difference/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">MariaDB vs. MySQL: What’s The Difference?</a></li>\n<li><a href=\"https://mariadb.com/blog/installing-mariadb-10010-mac-os-x-homebrew\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Installing MariaDB 10.0.10 on Mac OS X with Homebrew</a></li>\n<li><a href=\"https://mariadb.com/kb/en/mariadb/building-mariadb-on-mac-os-x-using-homebrew/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Building MariaDB on Mac OS X Using Homebrew</a></li>\n</ul>","frontmatter":{"title":"Mac 用 Homebrew 安裝 MariaDB","date":"December 09, 2015","description":"Homebrew 套件管理安裝資料庫","tags":["homebrew","mysql","mariadb"],"donation":false}},"previous":{"fields":{"slug":"/github-setting-up-jekyll-site/"},"frontmatter":{"title":"GitHub 架設 Jekyll 網站"}},"next":{"fields":{"slug":"/image-optimization/"},"frontmatter":{"title":"圖片最佳化"}}},"pageContext":{"id":"7062f5b0-0302-5860-98b7-84162f2ad67f","previousPostId":"adb5ea05-f5ce-574d-8b48-8a82d90337b0","nextPostId":"755e2a20-77e7-56cf-ae00-7e6f2e6403dc"}},"staticQueryHashes":["2841359383"]}