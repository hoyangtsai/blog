{
    "componentChunkName": "component---src-templates-blog-post-js",
    "path": "/excel-get-value-of-last-non-empty-cell/",
    "result": {"data":{"site":{"siteMetadata":{"title":"Traverse"}},"markdownRemark":{"id":"f926c4d2-1f2c-5904-b4c5-2db6190c6c1f","excerpt":"在網路上找到一個公式是可以將一個單元 (cell) 的值設定成某一列的數據中最後一個非空的值 在這之前先了解一下 LOOKUP 公式 如果想知道一個值在一列數據中落在哪一個單元 (cell) 就可以用到 LOOKUP…","html":"<p>在網路上找到一個公式是可以將一個單元 (cell) 的值設定成某一列的數據中最後一個非空的值</p>\n<p>在這之前先了解一下 LOOKUP 公式</p>\n<!-- more -->\n<p>如果想知道一個值在一列數據中落在哪一個單元 (cell) 就可以用到 LOOKUP</p>\n<div class=\"gatsby-highlight\" data-language=\"excel\"><pre class=\"language-excel\"><code class=\"language-excel\">=LOOKUP(查找值, 查找陣列, [結果陣列])</code></pre></div>\n<p>結果陣列的長度必須和查找陣列長度相等</p>\n<p>如果沒傳入第三個參數-結果陣列，就會基於查找陣列返回一個最接近的結果，查找值和查找陣列的邏輯是大於或等於</p>\n<p>如果傳入結果陣列就會回傳與查找陣列映射相同位置的值</p>\n<p>應用場景如分數級距評語</p>\n<div class=\"table-container\">\n<table>\n  <thead>\n    <tr>\n      <th>A</th>\n      <th>B</th>\n      <th>C</th>\n      <th>D</th>\n      <th>E</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>1</td>\n      <td>欠佳</td>\n      <td>&nbsp;</td>\n      <td>&nbsp;</td>\n      <td>&nbsp;</td>\n    </tr>\n    <tr>\n      <td>6</td>\n      <td>尚可</td>\n      <td>&nbsp;</td>\n      <td>&nbsp;</td>\n      <td>&nbsp;</td>\n    </tr>\n    <tr>\n      <td>9</td>\n      <td>很好</td>\n      <td>&nbsp;</td>\n      <td>&nbsp;</td>\n      <td>&nbsp;</td>\n    </tr>\n    <tr>\n      <td>&nbsp;</td>\n      <td>&nbsp;</td>\n      <td>得分</td>\n      <td>級別</td>\n      <td>評語</td>\n    </tr>\n    <tr>\n      <td>&nbsp;</td>\n      <td>&nbsp;</td>\n      <td>&nbsp;</td>\n      <td><code class=\"language-plaintext highlighter-rouge\"> =LOOKUP(C5,A1:A3)</code></td>\n      <td><code class=\"language-plaintext highlighter-rouge\"> =LOOKUP(C5,A1:A3,B1:B3)</code></td>\n    </tr>\n  </tbody>\n</table>\n</div>\n<p>如果我們在得分下面 C5 輸入 1~5 分，級別會是 1，評語會是欠佳</p>\n<p>輸入 6~8 分，級別會是 6，評語會是尚可</p>\n<p>輸入 9 分以上，級別會是 9，評語會是很好</p>\n<p>回到主題</p>\n<p>取得一列中最後一個非空的值的公式</p>\n<div class=\"gatsby-highlight\" data-language=\"excel\"><pre class=\"language-excel\"><code class=\"language-excel\">=LOOKUP(1,1/(A:A&lt;&gt;&quot;&quot;),A:A)</code></pre></div>\n<p>如果是表格，可以指定某一列名稱</p>\n<div class=\"gatsby-highlight\" data-language=\"excel\"><pre class=\"language-excel\"><code class=\"language-excel\">=LOOKUP(1,1/(表格1[合計股]&lt;&gt;&quot;&quot;),表格1[合計股])</code></pre></div>\n<p>這公式的意思是</p>\n<ol>\n<li>A:A&#x3C;>\"\" 回傳的是一組 {FALSE, TRUE, TRUE, FALSE, FASLE… }，有值的單元為 TRUE 空的為 FALSE</li>\n<li>數字 1 除以 A:A&#x3C;>\"\" 的陣列回傳另外一個新的陣列，其中包含一連串的 TRUE 或 #DIV/0! (1 / TRUE = TRUE, 1 / FALSE = #DIV/0!)</li>\n<li>LOOKUP 公式說明中的備註\n<ul>\n<li>如果 LOOKUP 函數找不到 lookup_value，就會比對 lookup_vector 中小於或等於 lookup_value 的最大值。</li>\n<li>如果 lookup_value 小於 lookup_vector 中的最小值，LOOKUP 函數會傳回 #N/A 的錯誤值。</li>\n</ul>\n</li>\n<li>在上面公式中，查找值是 2 ，但是查找陣列中最大的值是 1 (TRUE 也表示 1)，所以 lookup 回傳陣列中最後一個匹配</li>\n<li>最後 LOOKUP 會回傳相對於結果陣列位置的值</li>\n</ol>\n<p>應用場景如記錄股票的交易</p>\n<p>可以做像這樣的表</p>\n<div class=\"table-container\">\n<table>\n  <thead>\n    <tr>\n      <th>&nbsp;</th>\n      <th>A</th>\n      <th>B</th>\n      <th>C</th>\n      <th>D</th>\n      <th>E</th>\n      <th>F</th>\n      <th>G</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>1</td>\n      <td>總成本</td>\n      <td><code class=\"language-plaintext highlighter-rouge\">=SUM(表格1[成本])</code></td>\n      <td>&nbsp;</td>\n      <td>&nbsp;</td>\n      <td>&nbsp;</td>\n      <td>&nbsp;</td>\n      <td>&nbsp;</td>\n    </tr>\n    <tr>\n      <td>2</td>\n      <td>總計股</td>\n      <td style=\"width: 20%;\"><code class=\"language-plaintext highlighter-rouge\">=LOOKUP(2,1/(表格1[合計股]<>\"\"),表格1[合計股])</code></td>\n      <td>&nbsp;</td>\n      <td>&nbsp;</td>\n      <td>&nbsp;</td>\n      <td>&nbsp;</td>\n      <td>&nbsp;</td>\n    </tr>\n    <tr>\n      <td>3</td>\n      <td>平均成本</td>\n      <td><code class=\"language-plaintext highlighter-rouge\">=(B1/B2)</code></td>\n      <td>&nbsp;</td>\n      <td>&nbsp;</td>\n      <td>&nbsp;</td>\n      <td>&nbsp;</td>\n      <td>&nbsp;</td>\n    </tr>\n    <tr>\n      <td>4</td>\n      <td>日期</td>\n      <td>成交價</td>\n      <td>買入</td>\n      <td>賣出</td>\n      <td>手續費</td>\n      <td>成本</td>\n      <td>合計股</td>\n    </tr>\n    <tr>\n      <td>5</td>\n      <td>02/10</td>\n      <td>100</td>\n      <td>10</td>\n      <td>&nbsp;</td>\n      <td>1.99</td>\n      <td>-1101.99</td>\n      <td>10</td>\n    </tr>\n    <tr>\n      <td>6</td>\n      <td>03/11</td>\n      <td>90</td>\n      <td>20</td>\n      <td>&nbsp;</td>\n      <td>1.99</td>\n      <td>-1801.99</td>\n      <td>30</td>\n    </tr>\n    <tr>\n      <td>7</td>\n      <td>03/25</td>\n      <td>150</td>\n      <td>&nbsp;</td>\n      <td>10</td>\n      <td>3.99</td>\n      <td>1496.01</td>\n      <td>20</td>\n    </tr>\n    <tr>\n      <td>8</td>\n      <td>04/17</td>\n      <td>100</td>\n      <td>30</td>\n      <td>&nbsp;</td>\n      <td>1.99</td>\n      <td>-3001.99</td>\n      <td>50</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n<p>當然也可以直接 <code class=\"language-text\">=SUM(表格1[買入]) - SUM(表格1[賣出])</code></p>\n<p>但是當股票有配發股利（新增欄位）就必須修改總計股公式</p>\n<p>此公式目的是希望<strong>統計數據</strong>到表格某一欄中再取該欄最後一行的值</p>\n<h2 id=\"reference\" style=\"position:relative;\"><a href=\"#reference\" aria-label=\"reference permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reference</h2>\n<ul>\n<li><a href=\"https://exceljet.net/formula/get-value-of-last-non-empty-cell\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Get value of last non-empty cell</a></li>\n<li><a href=\"https://support.office.com/zh-tw/f1/topic/csh?HelpId=xlmain11.chm60076&#x26;NS=MACEXCEL&#x26;Version=90&#x26;Lcid=1028&#x26;UiLcid=1028&#x26;EntryPoint=True&#x26;testtransaction=0&#x26;feedback=0\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">LOOKUP 函數</a></li>\n</ul>","frontmatter":{"title":"Excel 取得一列中最後一個非空的值","date":"June 13, 2021","description":"Excel 取得一列中最後一個非空的值","tags":["excel"],"donation":false}},"previous":{"fields":{"slug":"/macbook-air-m1-review/"},"frontmatter":{"title":"Macbook Air M1 心得"}},"next":{"fields":{"slug":"/develop-super-easy-chatbot-release-online/"},"frontmatter":{"title":"開發超簡單聊天機器人發布線上"}}},"pageContext":{"id":"f926c4d2-1f2c-5904-b4c5-2db6190c6c1f","previousPostId":"64aa2901-270b-56b5-b73c-61c49917ed89","nextPostId":"77ea4751-68da-5855-840e-03e92336a2ec"}},
    "staticQueryHashes": ["2841359383"]}